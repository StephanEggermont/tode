TDDirectoryNode{#name:'bin',#contents:{'log':TDTxtLeafNode{#name:'log',#contents:Text{#string:'dkh 9/4/2013 01:24\r  - commit command returns committed versions...\rdkh 9/3/2013 10:11\r  - fix ./load so that it doesn\'t choke if a non-git repo is being loaded\r    also fix commit the same way...\r  - mapRepos needs to NOT map repositories if there is a repo specified for the \r    package itself\r',#runs:RunArray{#runs:[86,211],#values:[[TextColor{#color:Color{#rgb:0}}],[]],#lastIndex:nil,#lastRun:nil,#lastOffset:nil}}},'commit':TDScriptLeafNode{#name:'commit',#contents:'[ :topez :objIn :tokens :windowId | \n| projectName commitMessage mmTool commitedVersions |\n\"/home/bin/commit Tode `commit message`\r/home/bin/commit Tode @commitMessage\"\nprojectName := tokens at: 2.\ncommitMessage := tokens at: 3.\nmmTool := topez toolInstanceFor: \'mm\'.\n(commitMessage beginsWith: \'@\')\n  ifTrue: [ commitMessage := (mmTool resolveAtPathReference: commitMessage) asString ].\nTranscript\n  cr;\n  show: \'======= committing \' , projectName printString , \'=======\'.\ncommitedVersions := mmTool mmCommit: projectName commitMessage: commitMessage.\ncommitedVersions isEmpty\n  ifTrue: [ \'No dirty packages to commit\' ]\n  ifFalse: [ \n    | repo |\n    repo := (topez lookup: \'repo\') dotSelfObject.\n    repo class description = MCFileTreeRepository description\n      ifTrue: [ \n        | status statusNode gitRepoDir gitTool commitMessageFileName |\n        gitRepoDir := (topez lookup: \'gitRepo\') dotSelfObject.\n        gitTool := topez toolInstanceFor: \'git\'.\n        commitMessageFileName := gitTool createTmpFileWith: commitMessage.\n        gitTool\n          gitaddIn: gitRepoDir with: \'.\';\n          gitstatusIn: gitRepoDir with: \'\';\n          gitcommitIn: gitRepoDir with: \'-a --file=\' , commitMessageFileName;\n          gitstatusIn: gitRepoDir with: \'\'.\n        status := gitTool gitlogIn: gitRepoDir with: \'-1\'.\n        Transcript\n          cr;\n          show: \'==============\'.\n        statusNode := topez\n          lookup: \'status\'\n          ifAbsent: [ \n            topez currentNode\n              addChildNode:\n                (TDTxtLeafNode new\n                  name: \'status\';\n                  yourself) ].\n        statusNode contents: status.\n         commitedVersions] ] ]'},'create':TDScriptLeafNode{#name:'create',#contents:'[ :topez :objIn :tokens :windowId | \n| directoryName projectName repositoryDescription directoryNode status useConfig useCypress |\n\"/home/bin/create tode Tode filetree:///opt/git/tode/repository [baseline|config|cypress]\"\ndirectoryName := tokens at: 2.\nprojectName := tokens at: 3.\nrepositoryDescription := tokens at: 4.\nuseConfig := false.\nuseCypress := false.\ntokens size > 4\n  ifTrue: [ \n    useConfig := (tokens at: 5) = \'config\'.\n    useCypress := (tokens at: 5) = \'cypress\' ].\ndirectoryNode := topez\n  lookup: directoryName\n  ifAbsent: [ \n    topez currentNode\n      addChildNode:\n        (TDDirectoryNode new\n          name: directoryName;\n          yourself) ].\nuseConfig\n  ifTrue: [ \n    status := \'edit ./load to set correct project version number and load list\'.\n    directoryNode\n      addChildNode:\n          (TDTopezLeafNode new\n              name: \'commit\';\n              contents:\n                  \'/home/bin/commitConfig \' , projectName , \' @commitMessage\';\n              yourself);\n      addChildNode:\n          (TDTopezLeafNode new\n              name: \'load\';\n              contents: \'/home/bin/loadConfig \' , projectName , \' 1.0.0 default\';\n              yourself);\n      yourself ]\n  ifFalse: [ \n    useCypress\n      ifTrue: [ \n    status := \'edit ./load if you don\'\'t want to use default and you are good to go & edit ./cypressRepo\'.\r        directoryNode\n          addChildNode:\n            (TDTopezLeafNode new\n              name: \'commit\';\n              contents:\n                  \'/home/bin/commitCypress \' , projectName , \' @cypressRepo @commitMessage\';\n              yourself) ]\n      ifFalse: [ \n    status := \'edit ./load if you don\'\'t want to use default and you are good to go\'.\r        directoryNode\n          addChildNode:\n            (TDTopezLeafNode new\n              name: \'commit\';\n              contents: \'/home/bin/commit \' , projectName , \' @commitMessage\';\n              yourself) ].\n    directoryNode\n      addChildNode:\n        (TDTopezLeafNode new\n          name: \'load\';\n          contents: \'/home/bin/load \' , projectName , \' default\';\n          yourself) ].\ndirectoryNode\n  addChildNode:\n      (TDTopezLeafNode new\n          name: \'browse\';\n          contents: \'browse project \' , projectName;\n          yourself);\n  addChildNode:\n      (TDTxtLeafNode new\n          name: \'commitMessage\';\n          contents: \'\';\n          yourself).\nuseCypress\n  ifTrue: [ \n    directoryNode\n      addChildNode:\n          (TDTopezLeafNode new\n              name: \'cypressRepo\';\n              contents: \'| repo |\rrepo := CypressFileSystemRepository\r  onUrl:\r    \' , repositoryDescription printString , \' asUrl\r  alias: \' , projectName printString , \'.\rrepo gemStoneFileoutsEnabled: true.\rrepo\';\n              yourself);\n      addChildNode:\n          (TDTopezLeafNode new\n              name: \'diff\';\n              contents: \'cym diff \' , projectName , \' @cypressRepo\';\n              yourself);\n      yourself ]\n  ifFalse: [ \n    directoryNode\n      addChildNode:\n        (TDTopezLeafNode new\n          name: \'diff\';\n          contents: \'mm diff \' , projectName;\n          yourself) ].\ndirectoryNode\n  addChildNode:\n      (TDObjectGatewayNode new\n          name: \'gitRepo\';\n          contents: \'| repo |\rrepo := (self topez lookup: \'\'repo\'\') dotSelfObject.\rrepo directory containingDirectory\';\n          yourself);\n  addChildNode:\n      (TDObjectGatewayNode new\n          name: \'repo\';\n          contents:\n              \'(TDMonticelloRepository fromDescription: \' , repositoryDescription printString\n                  , \') repository\';\n          yourself);\n  addChildNode:\n      (TDTxtLeafNode new\n          name: \'status\';\n          contents: status;\n          yourself);\n  yourself.\nstatus ]'},'primeRegistry':TDSmalltalkLeafNode{#name:'primeRegistry',#contents:'MetacelloProjectRegistration resetRegistry.\t\"reset registry and lock FileTree and Metacello projects\"\nMetacello new\n  baseline: \'FileTree\';\n  repository: \'filetree:///opt/git/gs/filetree/repository\';\n  lock.\nMetacello new\n  baseline: \'Metacello\';\n  repository: \'filetree:///opt/git/metacello-work/repository\';\n  lock.\nMetacelloProjectRegistration primeRegistryFromImage'},'halt':TDSmalltalkLeafNode{#name:'halt',#contents:'\"opportunity to use debugger\"\n| block |\nblock := [:arg | arg halt].\nblock value: 100'},'loadConfig':TDScriptLeafNode{#name:'loadConfig',#contents:'[ :topez :objIn :tokens :windowId | \n| projectName version loads repo description status statusNode |\n\"/home/bin/loadConfig Seaside 3.0.7.1 default\"\nprojectName := tokens at: 2.\nversion := tokens at: 3.\nloads := \'default\'.\ntokens size > 3\n  ifTrue: [ loads := tokens copyFrom: 3 to: tokens size ].\nrepo := (topez lookup: \'repo\') dotSelfObject.\ndescription := repo description.\nMetacello new\n  configuration: projectName;\n  repository: description;\n  get.\nMetacello new\n  configuration: projectName;\n  version: version;\n  repository: description;\n  onConflict: [ :ex | ex allow ];\n  onWarning: [ :ex | \n        Transcript\n          cr;\n          show: \'WARNING: \' , ex description.\n        ex resume ];\n  load: loads.\nstatusNode := topez\n  lookup: \'status\'\n  ifAbsent: [ \n    topez currentNode\n      addChildNode:\n        (TDTxtLeafNode new\n          name: \'status\';\n          yourself) ].\nstatusNode\n  contents:\n    \'Loaded Configuration: \' , projectName printString , \' version \'\n      , version printString , \' from: \' , repo description.\nstatus ]'},'load':TDScriptLeafNode{#name:'load',#contents:'[ :topez :objIn :tokens :windowId | \n| projectName loads repo description |\n\"/home/bin/load Tode `GemStone Dev`\"\nprojectName := tokens at: 2.\nloads := \'default\'.\ntokens size > 2\n  ifTrue: [ loads := tokens copyFrom: 3 to: tokens size ].\nrepo := (topez lookup: \'repo\') dotSelfObject.\ndescription := repo description.\nGsDeployer bulkMigrate: [Metacello new\n  baseline: projectName;\n  repository: description;\n  get.\nMetacello new\n  baseline: projectName;\n  repository: description;\n  onConflict: [ :ex | ex allow ];\n  onWarning: [ :ex | \n        Transcript\n          cr;\n          show: \'WARNING: \' , ex description.\n        ex resume ];\n  load: loads].\nrepo class description = MCFileTreeRepository description\n  ifTrue: [ \n    | gitRepo gitTool statusNode status |\n    gitRepo := (topez lookup: \'gitRepo\') dotSelfObject.\n    gitTool := topez toolInstanceFor: \'git\'.\n    status := gitTool performGitCommand: \'log\' in: gitRepo with: \'-1\'.\n    statusNode := topez\n      lookup: \'status\'\n      ifAbsent: [ \n        topez currentNode\n          addChildNode:\n            (TDTxtLeafNode new\n              name: \'status\';\n              yourself) ].\n    statusNode contents: status.\n    status ] ]'},'commitConfig':TDScriptLeafNode{#name:'commitConfig',#contents:'[ :topez :objIn :tokens :windowId | \n| projectName commitMessage mmTool commitedVersions |\n\"/home/bin/commitConfig Seaside30 `commit message`\r/home/bin/commitConfig Seaside30 @commitMessage\"\nprojectName := tokens at: 2.\ncommitMessage := tokens at: 3.\nmmTool := topez toolInstanceFor: \'mm\'.\n(commitMessage beginsWith: \'@\')\n  ifTrue: [ commitMessage := (mmTool resolveAtPathReference: commitMessage) asString ].\nTranscript\n  cr;\n  show: \'======= committing \' , projectName printString , \'=======\'.\ncommitedVersions := mmTool mmCommit: projectName commitMessage: commitMessage.\ncommitedVersions isEmpty\n  ifTrue: [ \'No dirty packages to commit\' ]\n  ifFalse: [ \n    | statusNode status version projectSpec |\n    projectSpec := Metacello image\n      project: projectName;\n      list.\n    MetacelloToolBox\n      updateDevelopment: projectSpec versionString\n      for: projectName\n      updatePackages: true\n      description: commitMessage.\r\tstatus := \'Committed Configuration: \' , projectName printString , \' version \'\r      , version printString , \' \' , commitMessage printString.\n    Transcript\n      cr;\n      show: \'==============\'.\n    statusNode := topez\n      lookup: \'status\'\n      ifAbsent: [ \n        topez currentNode\n          addChildNode:\n            (TDTxtLeafNode new\n              name: \'status\';\n              yourself) ].\n    statusNode contents: status.\n    status ] ]'},'import':TDScriptLeafNode{#name:'import',#contents:'[ :topez :objIn :tokens :windowId | \n| stonTool |\nstonTool := topez toolInstanceFor: \'ston\'.\nstonTool\n  stonImportFrom: \'/opt/git/tode/fast/home.ston\' to: (topez lookup: \'/\');\n  stonImportFrom: \'/opt/git/tode/fast/bin.ston\' to: (topez lookup: \'/home\').\ntopez setCurrentNode: (topez lookup: \'/home\') ]'},'export':TDScriptLeafNode{#name:'export',#contents:'[ :topez :objIn :tokens :windowId | \n| stonTool |\nstonTool := topez toolInstanceFor: \'ston\'.\nstonTool\n  stonExportNode: (topez lookup: \'/home\') to: \'/opt/git/tode/fast/home.ston\';\n  stonExportNode: (topez lookup: \'/home/bin\') to: \'/opt/git/tode/fast/bin.ston\' ]'},'commitCypress':TDScriptLeafNode{#name:'commitCypress',#contents:'[ :topez :objIn :tokens :windowId | \n| projectName commitMessage cypressTool cypressRepo gitRepoDir gitTool status statusNode commitMessageFileName |\n\"/home/bin/commitCypress Cypress  @cypressRepo @commitMessage\"\ncypressTool := topez toolInstanceFor: \'cym\'.\nprojectName := tokens at: 2.\ncypressRepo := cypressTool resolveAtPathReference: (tokens at: 3).\ncommitMessage := (cypressTool resolveAtPathReference: (tokens at: 4)) asString.\nTranscript\n  cr;\n  show: \'======= committing \' , projectName printString , \'=======\'.\ncypressTool cymSave: projectName to: cypressRepo.\ngitRepoDir := (topez lookup: \'gitRepo\') dotSelfObject.\ngitTool := topez toolInstanceFor: \'git\'.\ncommitMessageFileName := gitTool createTmpFileWith: commitMessage.\ngitTool\n  gitaddIn: gitRepoDir with: \'.\';\n  gitstatusIn: gitRepoDir with: \'\';\n  gitcommitIn: gitRepoDir with: \'-a --file=\' , commitMessageFileName;\n  gitstatusIn: gitRepoDir with: \'\'.\nstatus := gitTool gitlogIn: gitRepoDir with: \'-1\'.\nTranscript\n  cr;\n  show: \'==============\'.\nstatusNode := topez\n  lookup: \'status\'\n  ifAbsent: [ \n    topez currentNode\n      addChildNode:\n        (TDTxtLeafNode new\n          name: \'status\';\n          yourself) ].\nstatusNode contents: status.\nstatus ]'},'mapRepos':TDScriptLeafNode{#name:'mapRepos',#contents:'[ :topez :objIn :tokens :windowId | \n| spec version workingCopies mcTool newRepo |\n\"/home/bin/mapRepos Tode filetree:///opt/git/tode/repository\r /home/bin/mapRepos Tode @repo\r\r  ensure that all packages in project have the given repo in repository group.\"\nmcTool := topez toolInstanceFor: \'mc\'.\nnewRepo := mcTool resolveRepositoryReference: (tokens at: 3).\nspec := Metacello image\n  baseline: (tokens at: 2);\n  list.\nversion := spec version.\nworkingCopies := (version packages select: [ :pkgSpec | pkgSpec repositories isEmpty])collect: [ :pkgSpec | pkgSpec workingCopy ].\nworkingCopies := workingCopies select: [ :each | each notNil ].\nworkingCopies\n  do: [ :wc | \n    | rg |\n    rg := wc repositoryGroup.\n    rg repositories do: [ :repo | rg removeRepository: repo ].\n    rg addRepository: newRepo ] ]'},'createAccessors':TDScriptLeafNode{#name:'createAccessors',#contents:'[ :topez :objIn :tokens :windowId | \"/home/bin/createAccessors class\" | theClass newLine varName className target|\r\tclassName := tokens at: 2.\r\ttarget := Smalltalk at: className asSymbol ifAbsent: [ ^nil error: \'Class \', className printString, \' not found.\'].\r  newLine := Character lf asString.\r  theClass := target theNonMetaClass.\r  varName := \'newValue\'.\r  theClass instVarNames\r    do: [ :aSymbol | \r      | aSelector |\r      aSelector := aSymbol asString.\r      (theClass includesSelector: aSymbol)\r        ifFalse: [ \r          theClass\r            compileMethod:\r              aSelector , newLine , newLine\r                , \'   \"Return the value of the instance variable \'\'\' , aSelector\r                , \'\'\'.\"\' , newLine , \'   ^\' , aSelector , newLine\r            dictionaries: #()\r            category: #\'accessing\' ].\r      (theClass includesSelector: (aSelector , \':\') asSymbol)\r        ifFalse: [ \r          theClass\r            compileMethod:\r              aSelector , \': \' , varName , newLine , newLine\r                , \'   \"Modify the value of the instance variable \'\'\' , aSelector\r                , \'\'\'.\"\' , newLine , \'   \' , aSelector , \' := \' , varName\r                , newLine\r            dictionaries: #()\r            category: #\'updating\' ] ]] '}}}